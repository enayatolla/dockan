version: "3.8"

services:
   postgre:
      image: postgres:15.4
      container_name: postgres
      volumes:
         - dokkan_postgres_db:/var/lib/postgresql/data
      environment:
         POSTGRES_USER: postgres
         POSTGRES_PASSWORD: postgres
         POSTGRES_DB: shop
      networks:
         - dockannet

   redis:
      image: redis:7.2.4
      container_name: redis-db
      restart: always
      networks:
         - dockannet
      ports:
         - 6379:6379
      volumes:
         - ./db/redis:/data

   django:
      build: .
      image: dockan_django
      container_name: dokkan
      restart: always
      volumes:
         - .:/app
      ports:
         - 8000:8000
      networks:
         - dockannet
      depends_on:
         - postgre

networks:
   dockannet:

volumes:
   dokkan_postgres_db:
      external: true
